/** 
 * @file    model_mlp_f32_2_15_5_1.c
 * @brief
 *
 * @author  guo yao
 * @date    2025/11/10
 * @history
 * |    Date    |  Version  |   Author    |    Description   |
 * |------------| --------  |-------------|------------------|
 *
**/

#include "power_ai/ann/fcnn_eval.h"
#include "power_ai/common/typedef.h"

#define N_FEATURES (16)
#define N_OUT (1)

fcnn_eval *nn;

float32 weight0[32 * N_FEATURES] = {
    -0.6508202f, 0.5097722f, -1.2337228f, -0.0532521f, -1.1229159f, 1.6540470f, 0.6883647f, -1.6509614f, 0.1335228f,
    0.0460067f, -0.2202333f, -1.3118866f, 0.7373237f, 2.0290810f, -0.6669604f, -0.1141701f, -0.5836888f, 1.0575624f,
    -0.8581407f, 0.5379078f, -1.1681832f, 1.7231106f, 0.6035504f, -0.9893466f, -1.7404573f, -0.1867137f, 1.2667956f,
    0.0456978f, -2.3793497f, -0.3329405f, 0.8111563f, 0.1765173f, -1.2370082f, -0.2966934f, 0.7859013f, -0.2549526f,
    0.5172343f, -0.8871055f, 0.8238127f, 1.3556841f, 1.1215971f, -1.0273244f, -0.5082462f, -0.8267800f, -1.5794823f,
    0.5522782f, -1.1330785f, 1.7138086f, -0.6507874f, -0.6460680f, 1.8554818f, -1.1267276f, -2.0459743f, 0.6410382f,
    -0.2523375f, 0.6617880f, 0.5489376f, 0.4619852f, -0.4746024f, -0.0003697f, 0.0361954f, -0.5737439f, -0.3320549f,
    0.2147877f, -0.4091820f, 0.5105433f, -0.2549917f, 0.7256549f, 1.2967676f, 0.9143633f, 1.0621070f, 0.7043856f,
    -0.2308128f, 1.4318659f, -1.1624271f, -0.6279612f, 0.1247906f, 0.7840269f, 0.5204694f, -1.2611288f, 0.0309508f,
    -0.0346795f, 1.4158082f, -0.0007291f, 1.4361440f, -0.7668502f, -0.3260668f, -1.3728445f, 0.2873365f, -0.6063721f,
    -1.0292581f, 0.4178824f, 0.9157310f, -0.9692114f, -0.7804940f, -0.9260254f, -0.3859651f, -0.2297528f, -1.3349778f,
    -0.5134202f, -1.5800110f, 1.9949687f, 0.6244220f, -1.2177223f, 0.9915147f, -0.3082027f, 1.6118101f, 0.4218985f,
    -0.5460176f, 0.3491550f, -0.5527242f, -1.1854636f, -0.1138991f, -0.3635218f, 0.2389343f,
    0.0219384f, -0.9622598f, -0.0474813f, 0.7326358f, 0.5571648f, 0.2921778f, -0.3245001f, 0.3893674f, -0.9654438f,
    2.2474160f, -1.0582811f, 0.9508945f, 0.4187619f, 1.8211665f, 0.0920841f, -1.3716593f, 0.2471235f, 2.9266804f,
    0.6423155f, 0.4302339f, -0.3996561f, 0.3420596f, -0.5874935f, 2.5338809f, 1.9244964f, -0.3470271f, 0.5726929f,
    -0.1678111f, -0.0381233f, 0.9325519f, -1.8138476f, -0.3276415f, 0.4638781f, 0.0432210f, 0.4310687f, 0.3413879f,
    0.0613701f, 2.2624097f, 0.8661438f, -1.3162207f, -0.8462301f, -0.5522825f, -2.9120784f, -0.6661009f, 0.3629455f,
    0.0692336f, -1.7601512f, -0.0509949f, -0.4100059f, -0.7917813f, 0.6307179f, 0.7991157f, 0.7581872f, 0.5074538f,
    1.7198419f, 0.5657057f, -0.4438897f, -1.6415085f, -0.4491854f, -1.4732541f, -0.0721046f, -0.0621968f, -0.7799130f,
    -0.8931704f, 0.2878720f, -0.1283051f, 0.2643146f, 0.0279607f, -0.6581624f, -0.9437780f, 0.1023974f, -0.5773885f,
    -0.4854030f, -0.0779910f, -0.5788292f, -0.6201881f, -0.0638712f, -1.5210572f, -0.4404180f, -0.5646216f, 1.5218019f,
    -0.8500388f, 1.6136617f, -0.0473108f, 0.7795385f, -0.4595239f, 1.1187528f, -0.0563770f, 1.4184211f, 0.4886331f,
    -0.0749815f, 0.5359983f, -0.3824699f, -0.3304952f, 0.0394500f, 1.1265154f, -1.0702812f, 0.4781831f, -0.4871718f,
    0.3117734f, -1.6161221f, 1.0656620f, 0.5380436f, -1.5163982f, -0.4892797f, 1.7832994f, 0.2729692f, 1.4818417f,
    -1.0082130f, 0.6081049f, -0.7445643f, 0.4783432f, -1.4743328f, 1.3458422f, 1.6130120f,
    -1.8792262f, 1.8484673f, 1.3849861f, -0.1261131f, 0.1235739f, -1.1562306f, 0.9267980f, -0.8541842f, -0.5456453f,
    1.0807229f, 0.6871719f, 1.5999220f, 0.0857200f, 0.0643765f, -0.6652193f, 0.6315511f, -0.5935720f, -0.3014965f,
    0.2773518f, 0.3738276f, 2.8057125f, -1.5851799f, 0.2937420f, -1.1813222f, -1.1644892f, 0.5127671f, 1.8186038f,
    0.6733635f, 0.0446051f, 0.8645218f, 0.2109192f, 0.8471921f, -1.3501014f, -0.5335336f, 1.0280920f, -0.2099704f,
    0.2062016f, 0.2001522f, -0.7085050f, 0.2177808f, 0.8585515f, -0.6995553f, -0.2890121f, 0.4005589f, 0.2937216f,
    -1.2781181f, 0.2576154f, -0.6080619f, 0.0712092f, 0.8092759f, 1.6835956f, 0.6551799f, -1.4022904f, -0.8368019f,
    1.6680532f, -0.2821088f, 0.3304616f, 0.6977349f, 2.1132974f, -0.4811611f, 0.3562436f, -0.3571489f, -0.3633062f,
    -0.2573561f, 0.8150989f, 0.4466900f, 0.3240165f, -0.5003200f, -0.7883118f, 0.9135978f, -1.4993846f, 0.3240471f,
    -0.0786703f, -0.6282073f, 0.6964333f, 1.9262411f, -0.4138403f, -0.5713831f, 0.2393167f, -1.4803677f, 0.6192091f,
    -1.2230358f, -0.5584619f, 2.5682489f, -2.0353664f, -0.9020849f, 0.8208073f, -0.2073143f, -0.2207318f, 0.3983610f,
    0.4446491f, 0.8038915f, 0.7674370f, -1.8846617f, -0.2413774f, -1.0644690f, -0.9980274f, -0.2919966f, 1.2353963f,
    -0.0810859f, -1.1100687f, -0.9678230f, -0.8662646f, -0.5943546f, 2.0659289f, 1.5431497f, 1.3028007f, 1.2337964f,
    -0.6698953f, -0.3711852f, -0.4136081f, -1.9079890f, 1.1019910f, 1.6767138f, 1.3852598f,
    2.1921312f, 0.0481175f, -1.2405908f, 0.4048176f, 1.1256984f, 0.3633264f, -1.0617915f, 1.0527825f, 0.2477558f,
    1.4562189f, -0.2429982f, -1.6518938f, -0.4592452f, -0.0002562f, -0.4249942f, 0.0133688f, -2.0928664f, -1.0806789f,
    -0.4681670f, 1.8024806f, -0.9502344f, 0.6807205f, 0.7654162f, 0.2071097f, 0.5415439f, -0.0996957f, 0.0841828f,
    -1.9037290f, 1.4562030f, -1.0190254f, -0.5198560f, -1.8941003f, -0.2063970f, -0.7685220f, 1.2714125f, -0.2714935f,
    1.5606875f, -0.9305668f, 1.0281322f, 0.2408628f, 0.6902724f, -0.8226173f, 0.3194064f, 0.1231101f, -0.0017706f,
    -1.5258958f, -0.3917265f, -1.0027890f, -0.0123518f, 1.4658547f, -0.1357461f, -0.4692506f, 1.7537895f, 1.2408551f,
    -1.0364736f, 0.4056547f, -0.0220507f, -0.5188558f, 0.3028699f, 0.8829853f, 0.6599047f, -0.9827647f, 0.1630574f,
    -0.5546094f, -0.6929058f, -1.1079180f, -1.3225261f, -0.3769466f, 1.2947751f, 1.1869910f, -0.2721944f, -0.3839315f,
    1.2173061f, 0.3520667f, 0.1868585f, -0.0880355f, -1.2184259f, 1.3613113f, -0.5834544f, 0.1440031f, -1.8364466f,
    -2.4095514f, -1.1996737f, -0.1269129f, -1.4083146f, -1.6047010f, -0.6767282f, 0.8002746f, -0.8242048f, 1.3754098f,
    0.3047008f, 0.4144966f, -0.1588859f, -0.8592231f, 0.3026447f, -0.5526375f, -0.2731295f, -1.2286004f, 1.6610131f,
    -1.5276224f, 0.3496897f, -0.0150922f, 1.2200304f, -0.3669145f, -0.1294290f, -1.2042920f, 1.3880537f, 1.6230607f,
    1.3928531f, 0.0031761f, -0.1663288f, 1.1555502f, -0.8358593f, 0.5712551f, -1.1912474f,
    -1.0478365f, -1.1136146f, 0.6394537f, 1.2566550f, -1.1610464f, -0.4490665f, 1.1372979f, 0.5846997f, -0.6974382f,
    0.0052808f, -0.4434212f, -0.9992705f, -0.1363010f, 1.5254452f, 0.9428662f, -0.6302353f, 0.5549276f, -0.8851824f,
    -1.4923714f, 0.2020442f, -0.6122555f, -0.6531811f, 1.7007569f, 1.1970011f, -0.5528511f, -0.3609500f, -0.5051555f,
    1.3654335f, 0.4084178f, -1.2114935f, -1.2179333f, -1.6873614f, 0.1754161f, -0.6905042f, 0.2725515f, 1.4844683f,
    1.3279750f, 1.9778158f, 0.6046072f, -0.3197173f, -0.1245328f, 0.8629328f, 0.5655893f, 0.4081736f, -1.0202797f,
    -1.5422958f, -1.4439899f, 0.7143701f, -0.5655623f, 1.2160682f, 0.0954969f, 0.8861935f
};
float32 bias0[32] = {
    -0.1806168f, 1.5879613f, -0.0013965f, 0.2919338f, -0.1360423f, 0.3241651f, -2.0670045f, -1.4460087f, -1.2971079f,
    -1.0394535f, -1.0552253f, -0.4211424f, -0.2190345f, -2.5385418f, -0.0527316f, 2.3451896f, -0.6681031f, 0.2685561f,
    -1.2924532f, 1.4036543f, -0.0014405f, 1.7544188f, -0.5511924f, -0.5557422f, 1.2764035f, -0.4834069f, -0.3419060f,
    -1.0085552f, 0.7743430f, 0.6976389f, -0.7475765f, 0.5747182f
};

float32 weight1[N_OUT * 32] = {
    -0.2987093f,-0.6532073f,-1.1261930f, 0.7638378f, 0.7342755f, 0.1239465f,-1.2080830f,-0.6032410f,-1.1511680f, 1.1628686f, 2.7213236f, 0.6006663f,-0.0770681f, 0.9752861f,-0.8217321f,-0.6693695f, 1.1436699f,-1.1661124f, 0.6739187f,-2.0021027f,-0.5229118f,-0.2404613f,-0.7459757f,-1.1060466f, 0.0894217f, 0.3970337f,-0.7783343f, 0.3374465f, 0.3362343f, 0.8350035f, 0.9656302f, 0.2029904f
};
float32 bias1[N_OUT] = {0.5832757f};

float32 xMean[N_FEATURES] = {1.7475835f, 1.0661999f, 0.6822248f,-1.2487441f,-0.2725879f, 0.5471996f,-0.2631807f, 0.3157207f, 1.1646589f,-0.4165937f,-0.2720930f,-0.7808266f, 0.7845507f, 1.3166817f,-0.5393335f,-0.9792225f};
float32 xStd[N_FEATURES] = {-0.8318486f,-0.4756612f,-0.5157296f,-2.1550643f,-1.3050560f, 0.6955969f, 0.9732907f,-2.0307136f, 0.0182198f, 0.1090128f, 1.6924198f,-0.3762892f, 0.1391411f, 0.3999771f, 0.7094954f,-0.8356588f};

void MODEL_Init()
{
    DenseDefF32 layers[] = {
        {32, N_FEATURES, ACT_FN_RELU, weight0, bias0},
        {N_OUT, 32, ACT_FN_STRAIGHT, weight1, bias1},
    };
    nn = fcnn_eval_create_f32(layers, 2);
}

extern void TESTSTART_Task1(void);

extern void TESTEND_Task1(void);

void MODEL_Run()
{
    TESTSTART_Task1();
    float32 xRaw[N_FEATURES] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16};
    float32 xTf[N_FEATURES] = {0};
    for (uint8 i = 0; i < N_FEATURES; i++) {
        xTf[i] = (xRaw[i] - xMean[i]) / xStd[i];
    }
    fcnn_eval_forward_f32(nn, xTf);
    TESTEND_Task1();
}
