/** 
 * @file    model_mlp_f32_2_15_5_1.c
 * @brief
 *
 * @author  guo yao
 * @date    2025/11/10
 * @history
 * |    Date    |  Version  |   Author    |    Description   |
 * |------------| --------  |-------------|------------------|
 *
**/

#include "power_ai/ann/fcnn_eval.h"
#include "power_ai/common/typedef.h"

#define N_FEATURES (16)
#define N_OUT (1)

fcnn_eval *nn;

int16 weight0[32 * N_FEATURES] = {
    -336, -930, 946, 38, 476, 229, -367, 373, -718, -654, 126, -260, 989, 310, -691, 961, 324, 1019, -290, -264, 638,
    523, -752, -389, -242, -23, -7, -310, -217, -957, -767, -858, 863, 294, -181, -895, -68, -313, -759, -953, -111,
    -349, 553, -110, 328, 991, -287, -485, 448, -832, 202, 103, -301, 491, 740, -164, 97, -203, -286, -938, 939, 130,
    191, 28, 34, 608, -771, 348, 41, 149, 511, 949, -458, 240, -673, 78, 135, 793, -649, -617, -411, -629, 436, 857,
    -670, 893, -545, 996, -538, -694, 571, -214, -1020, -95, 738, 517, -201, 214, -604, -332, 954, -752, 108, -1018,
    -932, 477, -420, 712, -609, -794, -731, -369, -782, 607, 952, 891, 211, 320, -217, 819, 622, -205, 295, -47,
    -916, -958, -153, 965, -788, -867, -198, 905, 857, 170, 612, 651, -23, -156, -342, -140, -777, 469, 204, -419, 4,
    715, 519, -901, 932, 474, 931, 687, -460, -300, -811, -498, -192, -488, -955, -794, 901, 684, -733, 463, -187, 290,
    -218, 39, 681, -659, 413, 111, -475, 469, 400, 778, -231,
    -1020, 769, 21, 60, 561, -660, -229, 854, -817, -852, 209, -515, -609, -461, 553, -459, 976, -6, 212, -395, -339,
    475, -131, 578, 253, -33, -742, -786, -103, 466,
    128, -228, 276, -907, 262, 882, 990, 450, 716, -1002, 131, 1017, -998, -791, 526, -131, 621, 47, 934, -558, 287,
    -795, 540, -932, -224, -725, 946, 386, 270, -906, -985, 764, -802, -114, -1016, -624, -986, 624, -957, 686, 345,
    -520, 632, -196, -976, -419, -152, 512, 967, 681, 469,
    395, -318, 907, -949, -409, -765, -1003, 617, -606, -500, -35, 872, 945, 327, -591, 872, -132, -395, -305, 619, 446,
    279, -917, 357, -787, 331, -894, 208, 864, -913, -668, -672, 532, -192, -566, 666, 628, -495, 92, -904, 702, -905,
    -384, -176, 428, -554, 226, -900, 420, 78, -596,
    -934, -952, -839, 974, 140, -888, -791, 438, 781, -31, -546, -616, 183, 66, 6, 216, 919, 663, -155, 354, 611, 565,
    902, 373, -603, 547, -974, -139, 294, -272, 652, -522, 1004, -727, 172, -432, 265, 494, 613, -605, 46, 127, 521,
    -536, 334, 484, -916, 856, -462, 441, -652, -913, 412,
    -577, 682, 179, 101, 770, -692, 380, -51, -872, 3, -146, -519, -271, 321, -861, 27, 477, 829, 586, -78, -255, -625,
    504, -494, -879, 174, -551, -817, 880, -964, -504, -353, -638, 496, 993, -615, 904, -886, -91, -278, 427, 252, 670,
    -46, 399, -554, -18, -659, -322, 864, 631, -176, -
    842,
    221, 629, -265, 692, 205, 190, -377, 686, -80, -370, 675, 679, -506, -309, -333, -308, -995, -508, -476, -940, 55,
    -663, 802, -792, -736, 357, -331, -633, 821, -390, -890, -279, -529, -856, -852, 876, -495, 794, 701, -185, -756,
    124, -909, 244, 694, -273, 816, 276, -901, -78, 916, -91, -878, 217, -103, 91, 766, -677, 459, 445, 670, -881, 70,
    973, 80, -368, -859, -91, 179, -382, 109, 12, 449, 187, -954, -555, -26, -637, 380, 596, 580, -674, 751, 279, -105,
    -647, -729, 445, 759, 170, -384, -504, -275, -117, 33, -816, -995
};
int16 bias0[32] = {
    -300, -352, 778, 87, 64, 787, 6, 404, -668, 787, -936, 681, 114, -471, -55, 166, -867, -40, 661, 4, -799, -390,
    -605, -660, 275, 376, 802, -804, 424, 342, 48, -982
};

int16 weight1[32 * 32] = {
    1022, -429, -523, 510, 243, -328, 892, 282, 59, 6, 662, -676, -285, 479, -821, -38, -499, -995, 141, 675, -250,
    -178, 869, -323, 517, -553, -101, 203, 236, -510, -515, 611, 819, 361, 962, -155, 540, -506, -773, 167, 543, 428,
    765, 588, -928, -877, -33, -14, 302, 27, -675, 588, -1007, -809, -904, 263, 614, 720, 268, 265, 912, -595, 258,
    -657, -445, -510, -289, 805, -888, 43, -82, -996, 119, 511, -613, 1007, 185, -655, -557, 661, -481, 593, 867, 639,
    62, -617, 121, 617, 792, 295, 735, 793, 682, -247, 231, -219, -714, 899, -898, -116, 746, 255, -863, -154, 863,
    -951, 625, 481, 478, -407, -40, -949, 812, 958, 377, 163, 435, 202, 365, -481, -117, 421, -987, -116, 55, 635, -770,
    -227, 737, -670, -137, 257, 606, -59, -80, 234, 552, 320, 920, 555, 64, 849, 772, 133, 616, 651, -624, 518, 783,
    -278, 474, 139, -694, -331, -945, 35, 970, -614, -802, 430, 478, -672, -752, 197, 685, 9, -835, 21, 753, -299, 752,
    755, 664, 860, -710, -780, -975, 415, -103, -624, 13, 259, 866, -963, 406, -424, -289, -490, 216, 795, -324, -312,
    284, 993, -292, -293, -98, -579, -44, -340, 98, -14, 329, 978, 206, -22, 618, -1, 908, 979, 217, -263, -704, -265,
    455, -604, 1019, -18, 260, -8, -620, -408, -204, -62, 610, -969, -97, 548, 268, -177, -918, -250, 986, -831, 984,
    388, 255, 293, 404, -294, -881, -603, 332, -6, 205, -461, -215, -148, 499, 618, -1018, -1000, -49, 811, -449, -1006,
    347, 1005, -257, -169, -244, -996, -288,
    1011, -186, -220, -487, -691, -375, -180, -801, -342, -912, -998, 552, -318, -918, 981, -243, 617, 608, -468, -886,
    -828, -360, 746, -158, 805, -921, -844, 144, -729, -590, 398, -884, -479, 119, -549, 758, -306, 333, 964, 423, -969,
    -516, -106, 710, -214, 219, 251, -839, -646, -
    468,
    -387, -1011, -542, -864, 653, 255, 780, 688, -932, 348, -435, 131, -50, -966, -310, -572, -471, -923, 242, -92,
    -438, 428, 533, 171, -90, 985, -609, -287, 811, -642, -264, -536, -890, 296, 931, -466, -318, 12, -968, 867, 103,
    -295, 949, 871, -609, -780, 896, 776, -263, -642,
    -387, 162, 418, 533, -367, -685, -123, 243, -923, 443, 252, 943, 61, 732, 867, -374, 380, -832, -144, 192, -485,
    540, 154, 488, -265, 282, 691, -559, 717, 950, -327, -366, 588, 172, 141, 850, 352, 357, -876, 951, -646, -913, -81,
    939, 833, 546, -219, 603, 225, 964, -800, -1007, -652, 60, 732, -396, -987, -668, -364, -634, 370, -149, -388, -934,
    348, -926, 543, -382, 585, -790, -617, -361, -75, -416, 877, 666, 216, 367, 669, 741, 345, 618, -189, 645, 408,
    -546, -382, 988, 525, -884, 165, 285, -490, 239, -671, -994, 219, -626, -653, 926, -715, -470, -392, 461, -816, 319,
    -877, 137, 947, -944, 203, -448, 313, -793, -630, 606, 933, 986, -828, 245, -583, -955, -170, -475, -812, -880,
    -652, 741, -1017, 951, 653, 707, -780, 614, -538, 1013, 446, 421, -278, 850, -715, -917, -315, -159, 674, 745, 907,
    696, -863, -653, -998, -128, 977, -678,
    472, 312, -474, -563, 712, -897, -353, -388, -249, -947, -92, -446, 890, 850, -697, -636, -57, 217, -389, -455, -14,
    2, -13, 132, -924, 506, -254, -845, 528, -478, 128, 762, -815, 283, -312, -633, -248, 751, -273, -979, -61, -704,
    198, -221, 186, -928, 428, 460, -61, -143, -866, 742, -653, -778, -723, 495, 240, 918, -884, 655, -102, -879, -611,
    1018, -504, -899, 411, 695, -119, 820, 49, -819, -486, 410, -18, -507, 643, 240, 245, 939, 694, -211, -607, -807,
    -248, -454, -315, 203, -544, -469, -279, 144, 328, -898, -81, 970, -13, -626, -242, -709, -443, 620,
    -510, -188, -720, -71, -728, 483, -551, -204, 495, -185, -547, -890, 20, 317, -907, -575, -781, -467, -414, -44,
    -704, -816, -212, -974, -914, -222, 652, -607, -39, -319, 939, 672, 998, -811, 563, 641, 136, -571, -488, -868, 2,
    577, -20, 471, -255, -833, 52, 457, 636, 378, 122, -833, -67, -235, -524, 605, 884, -3, 281, 692, 278, -680, 292,
    869, -703, 646, 885, -595, -398, 378, -511, 129, -976, 457, -272, 915, -15, -290, 804, -922, -25, 564, 814, -150,
    732, -921, 837, -122, 211, -58, -375, 91, 1006, 502, -396, -886, -676, -563, 787, -653, 621, 436, -188, -236, 161,
    772, -536, 746, 374, -905, 792, 34, -447, 638, -294, 58, -1006, 438, 535, -262, 521, 746, -347, -211, -999, 527,
    -213, -820, 738, 299, 60, -935, -625, 574, 920, -729, -483, 304, 366, 858, 157, -347, 541, 167, -761, -370, 254,
    408, 591, 597, -227, -242, -485, 754, -488, 243,
    993, 507, 194, 31, 888, 919, -570, 511, -267, 915, -589, 21, 485, 480, 322, 219, -381, -605, 465, 327, -172, -351,
    -1008, -775, -259, 801, 31, -867, -174, 22, -128, 944, -113, 75, 198, -26, -68, 662, -92, -184, -921, -694, 617,
    -798, -771, 574, -915, -345, 974, 893, 306, -891, -477, -985, 955, 519, -428, -738, -46, -221, 809, -390, 821, -754,
    -293, 414, -861, 735, 289, 904, 797, 115, -226, 470, 143, -94, -415, 84, 354, 97, -56, -501, 228, -272, -644, -608,
    669, -61, 690, -462, -980, -453, 416, 586, -1019, 749, 570, 476, -678, -569, -164, -927, -416, 298, -488, -687, 366,
    591, -889, -444, 7, 975, 853, -487, -898, -833, -677, 978, -215, -942, 304, -997, -592, 1007, 1009, -711, -951, 93,
    683, -492, 1002, 18, 807, 530, 511, 169, 540, 721, -45, -294, 202, 113, -203, 58, 667, 845, 902, -974, -572, -349,
    393, 596, -341, 92, 603, -144, 87, -677, 221, -511, -835, -80, -332, 41, 136, -550, 678, -140, -106, 678, 344, 966,
    357, 610, 408, -635, -502, 587, -66, -915, -125, -936, -733, -412, -285, 496, -1013, 755, -260, -139, 685, -981,
    -925, -6, -326, 17, 115, 762, -71, 77, 682, -717, 51, 447, 819, 858, -842, 544, -274, 358, -492, 879, 151, -570,
    -87, -269, 916, 866, 563, 179, 285, 93, -321, 577, 817, 642, 48, -639, 120, -427, -84, 280, 934, -691, -816, 293,
    954, 930, -632, 117, 938, 851, 286, 801, -3, -308, 168, 779, 770
};
int16 bias1[32] = {
    550, -322, -307, -865, 229, 228, 227, 84, 663, 1005, 386, -697, 412, 668, 906, -903, 527, -424, -539, 195, -972,
    -205, -990, 149, -936, -195, 964, 117, -400, -81, 992, -605
};

int16 weight2[N_OUT * 32] = {
    599, -360, -1022, -865, 943, -974, 113, -981, -274, 563, -909, 431, -307, 860, -377, 963, 257, 282, 917, 322, -587,
    -230, 207, -643, -922, 470, 382, 959, -347, -275, -48, 856
};
int16 bias2[N_OUT] = {876};

int16 xMean[N_FEATURES] = {
    866, -638, 584, -938, -828, 786, 920, -361, 465, -45, -986, -879, 507, -960, 947, 650
};
int16 xStd[N_FEATURES] = {
    866, -638, 584, -938, -828, 786, 920, -361, 465, -45, -986, -879, 507, -960, 947, 650
};


void MODEL_Init()
{
    DenseDefI16 layers[] = {
        {32, N_FEATURES, ACT_FN_RELU, weight0, bias0},
        {32, 32, ACT_FN_RELU, weight1, bias1},
        {N_OUT, 32, ACT_FN_STRAIGHT, weight2, bias2}
    };
    nn = fcnn_eval_create_i16(layers, 3);
}

extern void TESTSTART_Task1(void);

extern void TESTEND_Task1(void);

void MODEL_Run()
{
    TESTSTART_Task1();
    int16 xRaw[N_FEATURES] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16};
    int16 xTf[N_FEATURES] = {0};
    for (uint8 i = 0; i < N_FEATURES; i++) {
        xTf[i] = (int16) ((xRaw[i] - xMean[i]) / xStd[i]);
    }
    fcnn_eval_forward_i16(nn, xTf);
    TESTEND_Task1();
}
