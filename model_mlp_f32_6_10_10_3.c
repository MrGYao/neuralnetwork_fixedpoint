/** 
 * @file    model_mlp_f32_2_15_5_1.c
 * @brief
 *
 * @author  guo yao
 * @date    2025/11/10
 * @history
 * |    Date    |  Version  |   Author    |    Description   |
 * |------------| --------  |-------------|------------------|
 *
**/

#include "power_ai/ann/fcnn_eval.h"
#include "power_ai/common/typedef.h"

#define N_FEATURES (6)
#define N_OUT (3)

fcnn_eval *nn;

float32 weight0[10 * N_FEATURES] = {
    1.4538563f, 0.3128403f, 1.2832529f, 1.3002746f, 0.2835687f, 0.1055324f, -1.1717285f, -0.9114084f, 1.0611148f,
    -0.1703423f, 0.6920844f, 0.0170952f, -0.5095452f, 0.0098681f, 0.3164367f, 1.4301359f, 1.8010016f, 0.0165925f,
    -1.2364721f, 0.0604162f, 0.4853529f, 0.1519829f, -0.0315701f, -0.7817163f, 1.0838437f, 0.9517104f, -0.9571902f,
    1.4509072f, 1.1342705f, -1.6757577f, 0.4322896f, 0.3530329f, 0.8540428f, 0.4918408f, 1.1433227f, 0.0834394f,
    -0.1062019f, -1.2108204f, 1.2062705f, 0.4685001f, -1.1902658f, -0.3447663f, -0.1138469f, 0.3577279f, -0.0045280f,
    -0.0406161f, 0.1558514f, 0.2869062f, -0.8303592f, 0.9945405f, -0.5179200f, 0.0818005f, 1.0442957f, 0.1354387f,
    -0.4918323f, 2.0149401f, -1.0956007f, 0.5754245f, -1.6004412f, -0.6826009f
};
float32 bias0[10] = {
    0.9578195f, -0.3637087f, -0.0273836f, 0.0660728f, 0.7067372f, -1.4174770f, 0.2363733f, -0.3743353f, 1.0283805f,
    -0.2243022f
};

float32 weight1[10 * 10] = {
    -0.6291720f, -0.2152828f, 0.5304791f, -0.2721740f, 0.4550977f, 1.9078257f, -0.7517549f, -0.1169576f, -0.6079521f,
    -0.2564783f, -0.9583450f, -0.8112417f, 2.1257044f, 0.8535914f, 0.9014053f, -0.5351585f, -1.1411693f, 1.1966407f,
    0.9547862f, 0.5481904f, 1.3601322f, -1.1923869f, 0.9030575f, 1.6056683f, -0.0280580f, 0.2355555f, -0.0501454f,
    0.5523738f,
    0.9672677f, 0.3315832f, 0.6950262f, 0.3620393f, -0.4882275f, -0.2314210f, -1.7214047f, -1.1393910f, 1.8354283f,
    -0.7074849f, 0.5140384f, 0.2521825f, -0.6843432f, -0.0704733f, -0.3046366f, -0.5784615f, 0.3908407f, -0.4931414f,
    0.4611891f, -2.4024867f, 0.1576677f, -0.2822824f, 0.0111974f, 2.6813971f, 0.1527389f, 1.0827819f, 1.4927868f,
    -0.5049803f, -0.9748130f, 1.8482739f, 1.0103685f, 0.6882826f, 0.7435355f, 1.3225507f, 1.4814538f, -0.0162465f,
    0.4067397f, 0.1141171f, 0.7419509f, -0.6018896f, -0.3814626f, -0.8516815f, -1.2404210f, -0.6192152f, -0.9870660f,
    -0.6138724f, 1.7379644f, -0.2840998f, 0.9294382f, 0.6532804f, 1.4662822f, 0.2570898f, -0.0798123f, -1.4656760f,
    2.5487939f, 1.1250355f, -0.4159650f, -0.7307464f, 0.3573577f, 1.2936155f, -0.1320928f, 1.6879824f, -0.9077765f,
    -0.1978632f, 0.0256959f, -0.4437290f, 1.3482854f, -1.4711466f, -0.1690390f, -0.8636161f, -0.1787523f, 0.0940604f

};
float32 bias1[10] = {
    0.8057579f, -1.5147316f, -0.8266093f, -0.4593839f, -0.3804415f, 0.9106402f, -1.3233407f, 0.3233550f, -0.4696054f,
    0.1260062f
};

float32 weight2[N_OUT * 10] = {
    -1.2112619f, -0.2932546f, -0.1088120f, 1.3110426f, 0.0591565f, 0.4135983f, -0.1431235f, 1.1340861f, -0.4936135f,
    -0.1962295f, -0.0587013f, -0.4738738f, 1.5226588f, -0.9608051f, -0.2844077f, 1.1802085f, 0.3560694f, 0.7227901f,
    0.8617868f, -0.2070353f, 1.1974891f, -0.0937832f, 0.4434438f, -1.5504879f, 0.3069274f, 0.7655192f, -0.1478918f,
    1.3594259f, 1.4927004f, -0.0019335f
};
float32 bias2[N_OUT] = {-0.2088420f, -0.7713972f, -1.2318167f};

float32 xMean[N_FEATURES] = {-0.9216532f, -0.2435501f, 1.2f, 2.3f, -2.2f, 0.234f};
float32 xStd[N_FEATURES] = {0.5050835f, -0.6511153f, 0.3f, -0.1f, 0.2f, 0.5f};

void MODEL_Init()
{
    DenseDefF32 layers[] = {
        {15, N_FEATURES, ACT_FN_RELU, weight0, bias0},
        {5, 15, ACT_FN_RELU, weight1, bias1},
        {N_OUT, 5, ACT_FN_STRAIGHT, weight2, bias2}
    };
    nn = fcnn_eval_create_f32(layers, 3);
}

extern void TESTSTART_Task1(void);

extern void TESTEND_Task1(void);

void MODEL_Run()
{
    TESTSTART_Task1();
    float32 xRaw[N_FEATURES] = {1, 2, 3, 4, 5, 6};
    float32 xTf[N_FEATURES] = {0};
    for (uint8 i = 0; i < N_FEATURES; i++) {
        xTf[i] = (xRaw[i] - xMean[i]) / xStd[i];
    }
    fcnn_eval_forward_f32(nn, xTf);
    TESTEND_Task1();
}
